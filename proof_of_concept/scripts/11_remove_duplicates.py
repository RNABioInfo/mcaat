#load the list of lists of integers
#into one set and output it into a file

#input: list of lists of integers
#output: list of integers separated by comma
import sys
folder = "../data/"+sys.argv[1]+"/cycles_genome/"
#folder = "../data/"+sys.argv[1]+"/cycles/"

#read the file into set
#file format is following:
#10517386 3160927 3970026 1336774 473907 163477 8275119 10450987 3141889 3965572 6496651 2097535 762296 8451751 10517305 3160847 3969976 1336760 473899 163469 8275115 10450985 3141887 3965569 9356318 2857561 1001307 8530486 10549757 3169996 9145422 5337879 1783572 643725 8419339 10504763 3157014 3969109 6497231 2097688 762360 8451790 10517339 3160883 3970001 6497414 9988930 3020928 3945829 6493365 4815955 6648694 2145331 776019 5927057 4689042 1570119 8683416 10606673 7971021 5079522 4450557 6583062 10014029 3027471 6333599 6966773 4909255 9582629 2915600 9079789 10757499 3216938 3983026 6499691 2098434 762729 8452004 10517503 3161025 3970078 6497460 2097787 762430 8451843 10517386 
#10517386 3160927 3970026 1336774 473907 163477 8275119 10450987 3141889 3965572 6496651 2097535 762296 8451751 10517305 3160847 3969976 1336760 473899 163469 8275115 10450985 3141887 3965569 9356318 2857561 1001307 8530486 10549757 3169996 9145422 5337879 1783572 643725 8419339 10504763 3157014 3969109 6497231 2097688 762360 8451790 10517339 3160883 3970001 6497414 9988930 3020928 3945829 6493365 4815955 6648694 2145331 776019 5927057 4689042 1570119 8683416 10606673 7971021 5079522 4450557 6583062 10014029 3027471 6333599 6966773 4909255 9582629 2915600 9079789 10757499 3216938 3983026 6499691 2098434 762729 8452004 10517503 3161025 3970078 6497460 2097787 762430 8451843 10517386 
#10517386 3160927 3970026 1336774 473907 163477 8275119 10450987 3141889 3965572 6496651 2097535 762296 8451751 10517305 3160847 3969976 1336760 473899 163469 8275115 10450985 3141887 3965569 9356318 2857561 1001307 8530486 10549757 3169996 9145422 5337879 1783572 643725 8419339 10504763 3157014 3969109 6497231 2097688 762360 8451790 10517339 3160883 3970001 6497414 9988930 3020928 3945829 6493365 4815955 6648694 2145331 776019 5927057 4689043 6623948 10024363 11061264 8080149 5103292 4455356 6584068 10014308 3027560 6333628 6966790 4909269 9582642 2915610 9079799 10757509 3216946 3983036 6499700 2098438 762733 8452007 10517505 3161025 3970078 6497460 2097787 762430 8451843 10517386 
#10517386 3160927 3970026 1336774 473907 163477 8275119 10450987 3141889 3965572 6496651 2097535 762296 8451751 10517305 3160847 3969976 1336760 473899 163469 8275115 10450985 3141887 3965569 9356318 2857561 1001307 8530486 10549757 3169996 9145422 5337879 1783572 643725 8419339 10504763 3157014 3969109 6497231 2097688 762360 8451790 10517339 3160883 3970001 6497414 9988930 3020928 3945829 6493365 4815955 6648694 2145331 776019 5927057 4689043 6623948 10024363 11061264 8080149 5103292 4455356 6584068 10014308 3027560 6333628 6966790 4909269 9582642 2915610 9079799 10757509 3216946 3983036 6499700 2098438 762733 8452007 10517505 3161025 3970078 6497460 2097787 762430 8451843 10517386 
def read_file(folder, file_name):
    output_list = []
    with open(folder + file_name, "r") as f:
        output_list = [[int(n) for n in line.split()] for line in f]
    return output_list

id_paths= read_file(folder, "clusters.txt")
set_of_ids = set()

for i in id_paths:
    for j in i:
        set_of_ids.add(j)

with open(folder + "clusters_set.txt", "w") as f:
    for i in set_of_ids:
        f.write(str(i) + ",")

print("Length of clusters: ", len(set_of_ids))

print("Length of clusters without duplicate removal: ", len(id_paths))